---
import BlogPreview from '../components/BlogPreview.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import generateRSSFeed from '../services/generateRSSFeed.js';
import fs from 'node:fs';

const posts = Astro.fetchContent('./blog/*.md')
    .sort((a, b) => new Date(b.date) - new Date(a.date));
const rssFeed = generateRSSFeed(posts);
fs.writeFileSync("./public/rss.xml", rssFeed);
---
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <title>polpielladev ðŸ“± | A blog about software engineering and app development</title>
    <meta name="twitter:title" content="polpielladev ðŸ“± | A blog about software engineering and app development" />
    <meta name="twitter:description" content="A blog where I talk about software development topics in languages like Swift, Javascript and using frameworks such as Next.js, React, Combine and many more!" />
    <meta name="description" content="A blog where I talk about software development topics in languages like Swift, Javascript and using frameworks such as Next.js, React, Combine and many more!" />
    <meta name="twitter:site" content="@polcodes" />
    <meta name="twitter:card" content="summary_large_image" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="stylesheet" href="/style/global.css">
    <style>
        .home-container {
            margin: 0 auto;
            max-width: 900px;
            line-height: 1.5;
        }

        .intro > div {
            max-width: 400px;
        }

        .intro {
            display: flex;
            align-items: center;
            justify-content: left;
            gap: 20px;
            margin-bottom: 32px;
            padding: 16px;
        }

        .intro > img {
            object-fit: cover;
            border-radius: 50%;
            height: 100px;
            width: 100px;
        }
    </style>
</head>
<body>
    <main>
        <Header />
        <div class="home-container">
            <section class="intro">
                <img src="/assets/profile.png" />
                <div>
                    <h2>
                        Personal blog by <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/polcodes">Pol Piella</a> 
                    </h2>
                    <p>I talk about iOS development and my career as a software engineer.</p>
                </div>
            </section>
            <section>
                {posts.map(p => <BlogPreview post={p} />)}
            </section>
        </div>
        <Footer />
    </main>
</body>
</html>
